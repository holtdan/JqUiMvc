@using JqUiMvc.Models
@model VisitInfoViewModel
@{
    ViewBag.Title = ViewBag.TaskViewModel.CurrStep.Name;
}

@using (Html.BeginForm("VisitInfo_SAC", "Home", FormMethod.Post, new { @class = "form-horizontal", role = "form", area = "" }))
{
    @Html.HiddenFor(model => model.VisitID)
    @Html.HiddenFor(model => model.SiteID)
    @Html.HiddenFor(model => model.VisitTypeID)
    @Html.HiddenFor(model => model.StartDate)
    @Html.HiddenFor(model => model.EndDate)

    <div class="form-group">
        <div class="col-md-offset-2 col-md-10">
            @Html.EnumDropDownListFor(m => m.StepState, new { @class = "form-control" })
        </div>
    </div>

    <div class="form-group">
        @Html.LabelFor(model => model.VisitName, new { @class = "control-label col-md-2" })
        <div class="col-md-10">
            @Html.EditorFor(model => model.VisitName)
            @Html.ValidationMessageFor(model => model.VisitName)
        </div>
    </div>

    <div class="form-group">
        @Html.LabelFor(model => model.SiteID, new { @class = "control-label col-md-2" })
        <div class="col-md-10">
            @Html.DropDownListFor(m => m.SiteID, Model.SiteSelList, new { @class = "form-control" })
            @Html.ValidationMessageFor(model => model.SiteID)
        </div>
    </div>

    <div class="form-group">
        @Html.LabelFor(model => model.VisitTypeID, new { @class = "control-label col-md-2" })
        <div class="col-md-10">
            @Html.DropDownListFor(m => m.VisitTypeID, Model.VisitTypeSelList, new { @class = "form-control" })
            @Html.ValidationMessageFor(model => model.VisitTypeID)
        </div>
    </div>

    <div class="form-group">
        @Html.LabelFor(model => model.IsOffSite, new { @class = "control-label col-md-2" })
        <div class="col-md-10">
            @Html.RadioButtonFor(model => model.IsOffSite, true, new { @class = "filter", id = "Offsite_true" })
            <label for="Offsite_true">Yes</label>
            @Html.RadioButtonFor(model => model.IsOffSite, false, new { @class = "filter", id = "Onsite_true" })
            <label for="Onsite_true">No</label>
            @Html.ValidationMessageFor(model => model.IsOffSite)
        </div>
    </div>

    <div class="form-group">
        @Html.LabelFor(model => model.VisitLength, new { @class = "control-label col-md-2" })
        <div class="col-md-10">
            @Html.RadioButtonFor(model => model.VisitLength, VisitInfoViewModel.VLength.Hourly, new { @class = "filter", id = "VisitLength_hourly" })
            <label for="VisitLength_hourly">Hourly</label>
            @Html.RadioButtonFor(model => model.VisitLength, VisitInfoViewModel.VLength.Full, new { @class = "filter", id = "VisitLength_full" })
            <label for="VisitLength_full">Full Day</label>
            @Html.RadioButtonFor(model => model.VisitLength, VisitInfoViewModel.VLength.Multi, new { @class = "filter", id = "VisitLength_multi" })
            <label for="VisitLength_multi">Multi-day</label>
            @Html.ValidationMessageFor(model => model.VisitLength)
        </div>
    </div>

    <div class="form-group">
        @Html.LabelFor(model => model.NumAttendees, new { @class = "control-label col-md-2" })
        <div class="col-md-10">
            @Html.EditorFor(model => model.NumAttendees)
            @Html.ValidationMessageFor(model => model.NumAttendees)
        </div>
    </div>

    <div class="form-group">
        <label class="control-label col-md-2">Date</label>
        <div class="col-md-10">
            <a class="btn btn-primary" id="selectDateBtn">
                @if (Model.StartDate == null)
                {
                    @:Select Date
                }
                else
                {
                    @Model.StartDate.Value.ToShortDateString()@:&nbsp;-&nbsp;@Model.EndDate.Value.ToShortDateString()
                }
            </a>
        </div>
    </div>
    <div class="form-group">
        <label class="control-label col-md-2">Time</label>
        <div class="col-md-10" id="selectedTime">
            @if (Model.StartDate != null)
            {
                @Model.StartDate.Value.ToShortTimeString()@:&nbsp;-&nbsp;@Model.EndDate.Value.ToShortTimeString()
            }
        </div>
    </div>
    @* if ! AcctMgr *@
    <div class="form-group">
        <label class="control-label col-md-2">Room(s)</label>
        <div class="col-md-10">
        </div>
    </div>
}
<div id="beDlgGetDate">
</div>
@section Scripts
{
    <script type="text/javascript">
        $(function () {
            console.log("VisitInfo")
            dialog = $("#beDlgGetDate").dialog({
                autoOpen: false,
                //height: 500,
                //width: 400,
                modal: true,
                buttons: {
                    //"Create an account": addUser,
                    Cancel: function () {
                        dialog.dialog("close");
                    }
                },
                close: function () {
                    var startDate = new Date($("#StartDate").val());
                    var endDate = new Date($("#EndDate").val());
                    $("#selectDateBtn").text(startDate.toDateString() + " - " + endDate.toDateString())
                    $("#selectedTime").text(startDate.toTimeString() + " - " + endDate.toTimeString())
                    //form[0].reset();
                    //allFields.removeClass("ui-state-error");
                    dialog.dialog("close");
                }
            });
            $("#selectDateBtn").click(function (e) {
                //e.PreventDefault();
                e.stopPropagation();
                dialog.load("@Url.Action("GetCalendar", "Home", new { area = "" })");
                dialog.dialog("open");
            });
        });
    </script>
}
